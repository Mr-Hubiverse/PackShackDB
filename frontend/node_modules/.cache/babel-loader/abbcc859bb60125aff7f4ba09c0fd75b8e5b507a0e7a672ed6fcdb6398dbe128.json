{"ast":null,"code":"import React,{useState}from'react';import{Download,Loader2,AlertCircle}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DownloadButton=_ref=>{let{audioFileUrl,fileName='audio-file.wav'}=_ref;const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const handleDownload=async()=>{setIsLoading(true);setError(null);try{var _disposition$match$,_disposition$match;const response=await fetch(audioFileUrl);if(!response.ok){throw new Error(`Download failed: ${response.statusText}`);}// Extract filename from the Content-Disposition header or use the default fileName\nconst disposition=response.headers.get('Content-Disposition');const extractedFileName=(_disposition$match$=disposition===null||disposition===void 0?void 0:(_disposition$match=disposition.match(/filename=\"(.+)\"/))===null||_disposition$match===void 0?void 0:_disposition$match[1])!==null&&_disposition$match$!==void 0?_disposition$match$:fileName;// Read the file content as a Blob\nconst audioFileData=await response.blob();const url=URL.createObjectURL(audioFileData);// Create a temporary anchor element for downloading\nconst link=document.createElement('a');link.href=url;link.download=extractedFileName;document.body.appendChild(link);link.click();// Cleanup: remove the link and revoke the object URL\ndocument.body.removeChild(link);URL.revokeObjectURL(url);}catch(err){console.error('Error downloading file:',err);setError('Failed to download the audio file. Please try again.');}finally{setIsLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"inline-block\",children:[error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex items-center gap-2 text-red-500\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:error})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleDownload,disabled:isLoading,\"aria-busy\":isLoading,\"aria-label\":\"Download audio file\",className:\"flex items-center gap-2 bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md\",children:[isLoading?/*#__PURE__*/_jsx(Loader2,{className:\"h-5 w-5 animate-spin\"}):/*#__PURE__*/_jsx(Download,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:isLoading?'Downloading...':'Download Audio'})]})]});};export default DownloadButton;","map":{"version":3,"names":["React","useState","Download","Loader2","AlertCircle","jsx","_jsx","jsxs","_jsxs","DownloadButton","_ref","audioFileUrl","fileName","isLoading","setIsLoading","error","setError","handleDownload","_disposition$match$","_disposition$match","response","fetch","ok","Error","statusText","disposition","headers","get","extractedFileName","match","audioFileData","blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","err","console","className","children","onClick","disabled"],"sources":["/mnt/HDD/Docker/PackshackDB/frontend/src/components/DownloadButton.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Download, Loader2, AlertCircle } from 'lucide-react';\n\nconst DownloadButton = ({ audioFileUrl, fileName = 'audio-file.wav' }) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const handleDownload = async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(audioFileUrl);\n\n      if (!response.ok) {\n        throw new Error(`Download failed: ${response.statusText}`);\n      }\n\n      // Extract filename from the Content-Disposition header or use the default fileName\n      const disposition = response.headers.get('Content-Disposition');\n      const extractedFileName =\n        disposition?.match(/filename=\"(.+)\"/)?.[1] ?? fileName;\n\n      // Read the file content as a Blob\n      const audioFileData = await response.blob();\n      const url = URL.createObjectURL(audioFileData);\n\n      // Create a temporary anchor element for downloading\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = extractedFileName;\n      document.body.appendChild(link);\n      link.click();\n\n      // Cleanup: remove the link and revoke the object URL\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n    } catch (err) {\n      console.error('Error downloading file:', err);\n      setError('Failed to download the audio file. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"inline-block\">\n      {/* Error Message */}\n      {error && (\n        <div className=\"mb-4 flex items-center gap-2 text-red-500\">\n          <AlertCircle className=\"h-5 w-5\" />\n          <span className=\"text-sm\">{error}</span>\n        </div>\n      )}\n\n      {/* Download Button */}\n      <button\n        onClick={handleDownload}\n        disabled={isLoading}\n        aria-busy={isLoading}\n        aria-label=\"Download audio file\"\n        className=\"flex items-center gap-2 bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md\"\n      >\n        {isLoading ? (\n          <Loader2 className=\"h-5 w-5 animate-spin\" />\n        ) : (\n          <Download className=\"h-5 w-5\" />\n        )}\n        <span>{isLoading ? 'Downloading...' : 'Download Audio'}</span>\n      </button>\n    </div>\n  );\n};\n\nexport default DownloadButton;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,QAAQ,CAAEC,OAAO,CAAEC,WAAW,KAAQ,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE9D,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAmD,IAAlD,CAAEC,YAAY,CAAEC,QAAQ,CAAG,gBAAiB,CAAC,CAAAF,IAAA,CACnE,KAAM,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACc,KAAK,CAAEC,QAAQ,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAExC,KAAM,CAAAgB,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjCH,YAAY,CAAC,IAAI,CAAC,CAClBE,QAAQ,CAAC,IAAI,CAAC,CAEd,GAAI,KAAAE,mBAAA,CAAAC,kBAAA,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACV,YAAY,CAAC,CAE1C,GAAI,CAACS,QAAQ,CAACE,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,oBAAoBH,QAAQ,CAACI,UAAU,EAAE,CAAC,CAC5D,CAEA;AACA,KAAM,CAAAC,WAAW,CAAGL,QAAQ,CAACM,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC,CAC/D,KAAM,CAAAC,iBAAiB,EAAAV,mBAAA,CACrBO,WAAW,SAAXA,WAAW,kBAAAN,kBAAA,CAAXM,WAAW,CAAEI,KAAK,CAAC,iBAAiB,CAAC,UAAAV,kBAAA,iBAArCA,kBAAA,CAAwC,CAAC,CAAC,UAAAD,mBAAA,UAAAA,mBAAA,CAAIN,QAAQ,CAExD;AACA,KAAM,CAAAkB,aAAa,CAAG,KAAM,CAAAV,QAAQ,CAACW,IAAI,CAAC,CAAC,CAC3C,KAAM,CAAAC,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACJ,aAAa,CAAC,CAE9C;AACA,KAAM,CAAAK,IAAI,CAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACxCF,IAAI,CAACG,IAAI,CAAGN,GAAG,CACfG,IAAI,CAACI,QAAQ,CAAGX,iBAAiB,CACjCQ,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,IAAI,CAAC,CAC/BA,IAAI,CAACO,KAAK,CAAC,CAAC,CAEZ;AACAN,QAAQ,CAACI,IAAI,CAACG,WAAW,CAACR,IAAI,CAAC,CAC/BF,GAAG,CAACW,eAAe,CAACZ,GAAG,CAAC,CAC1B,CAAE,MAAOa,GAAG,CAAE,CACZC,OAAO,CAAC/B,KAAK,CAAC,yBAAyB,CAAE8B,GAAG,CAAC,CAC7C7B,QAAQ,CAAC,sDAAsD,CAAC,CAClE,CAAC,OAAS,CACRF,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,mBACEN,KAAA,QAAKuC,SAAS,CAAC,cAAc,CAAAC,QAAA,EAE1BjC,KAAK,eACJP,KAAA,QAAKuC,SAAS,CAAC,2CAA2C,CAAAC,QAAA,eACxD1C,IAAA,CAACF,WAAW,EAAC2C,SAAS,CAAC,SAAS,CAAE,CAAC,cACnCzC,IAAA,SAAMyC,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAEjC,KAAK,CAAO,CAAC,EACrC,CACN,cAGDP,KAAA,WACEyC,OAAO,CAAEhC,cAAe,CACxBiC,QAAQ,CAAErC,SAAU,CACpB,YAAWA,SAAU,CACrB,aAAW,qBAAqB,CAChCkC,SAAS,CAAC,2LAA2L,CAAAC,QAAA,EAEpMnC,SAAS,cACRP,IAAA,CAACH,OAAO,EAAC4C,SAAS,CAAC,sBAAsB,CAAE,CAAC,cAE5CzC,IAAA,CAACJ,QAAQ,EAAC6C,SAAS,CAAC,SAAS,CAAE,CAChC,cACDzC,IAAA,SAAA0C,QAAA,CAAOnC,SAAS,CAAG,gBAAgB,CAAG,gBAAgB,CAAO,CAAC,EACxD,CAAC,EACN,CAAC,CAEV,CAAC,CAED,cAAe,CAAAJ,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}