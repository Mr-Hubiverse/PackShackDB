"use strict";(self.webpackChunkpackshack_frontend=self.webpackChunkpackshack_frontend||[]).push([[650],{650:(e,a,s)=>{s.r(a),s.d(a,{default:()=>m});var t=s(43),l=s(772),r=s(797);const n=(0,r.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),i=(0,r.A)("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var d=s(987);const c=(0,r.A)("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),o=(0,r.A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var p=s(244),x=s(579);const h=[".wav",".mp3",".flac",".aiff"],m=()=>{const[e,a]=(0,t.useState)([]),[s,r]=(0,t.useState)(!1),[m,u]=(0,t.useState)(null),[y,f]=(0,t.useState)(!1),g=(0,t.useRef)(null),b=(0,t.useRef)(null),j=(0,t.useCallback)((e=>e.type.startsWith("audio/")||h.some((a=>e.name.toLowerCase().endsWith(a)))),[]),v=(0,t.useCallback)((e=>e.size/1024/1024<=500),[]),k=(0,t.useCallback)((e=>new Promise((a=>{const s=new Audio;s.src=URL.createObjectURL(e),s.addEventListener("loadedmetadata",(()=>{URL.revokeObjectURL(s.src),a(s.duration)})),s.addEventListener("error",(()=>{URL.revokeObjectURL(s.src),a(null)}))}))),[]),w=(0,t.useCallback)((async e=>{const a=await k(e);return{file:e,name:e.name,size:(e.size/1024/1024).toFixed(2),type:e.type||"audio/wav",duration:a?a.toFixed(2):null,lastModified:new Date(e.lastModified).toLocaleDateString(),path:e.webkitRelativePath||e.name}}),[k]),N=(0,t.useCallback)((async e=>{r(!0),u(null),f(!1);try{const s=Array.from(e.target.files),t=s.filter((e=>!j(e)));if(t.length>0)throw new Error(`Unsupported file type(s): ${t.map((e=>e.name)).join(", ")}`);const l=s.filter((e=>!v(e)));if(l.length>0)throw new Error(`Files exceeding 500MB: ${l.map((e=>e.name)).join(", ")}`);const r=await Promise.all(s.map((e=>w(e))));a(r)}catch(s){u(s.message),console.error("Folder selection error:",s)}finally{r(!1)}}),[j,v,w]),C=(0,t.useCallback)((e=>{a((a=>a.filter(((a,s)=>s!==e))))}),[]),U=(0,t.useCallback)((async()=>{r(!0),u(null),f(!1),b.current=new AbortController;try{const s=new FormData;e.forEach(((e,a)=>{s.append("files",e.file),s.append(`metadata${a}`,JSON.stringify({duration:e.duration||"unknown",type:e.type,lastModified:e.lastModified,path:e.path}))}));const t=await fetch("http://192.168.50.82:3001/api/upload",{method:"POST",body:s,signal:b.current.signal,headers:{Accept:"application/json"}});if(!t.ok){const e=await t.json().catch((()=>null));throw new Error((null===e||void 0===e?void 0:e.message)||`Upload failed: ${t.statusText}`)}a([]),f(!0),setTimeout((()=>f(!1)),3e3)}catch(s){"AbortError"===s.name?u("Upload cancelled"):(u(s.message||"Upload failed. Please try again."),console.error("Upload error:",s))}finally{r(!1),b.current=null}}),[e]),A=(0,t.useCallback)((()=>{b.current&&b.current.abort()}),[]);return(0,x.jsx)("div",{className:"max-w-4xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden",children:(0,x.jsxs)("div",{className:"p-8",children:[(0,x.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 hover:bg-gray-100 transition-colors duration-200",onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),N({target:{files:e.dataTransfer.files}})},children:[(0,x.jsx)("input",{id:"folderInput",type:"file",ref:g,onChange:N,className:"hidden",webkitdirectory:"true",directory:"true",multiple:!0,accept:h.join(",")}),(0,x.jsxs)("label",{htmlFor:"folderInput",className:"flex items-center gap-3 px-8 py-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all duration-200 cursor-pointer disabled:opacity-50",children:[s?(0,x.jsx)(l.A,{className:"animate-spin",size:24}):(0,x.jsx)(n,{size:24}),(0,x.jsx)("span",{className:"font-semibold",children:s?"Processing...":"Select Audio Folder"})]}),(0,x.jsxs)("p",{className:"mt-4 text-sm text-gray-500",children:["Drop a folder here or click to select. Supported formats: ",h.join(", "),". Max size: ",500," MB."]})]}),y&&(0,x.jsxs)(p.F,{className:"mt-6 bg-green-50 border-green-500",children:[(0,x.jsx)(i,{className:"h-5 w-5 text-green-500"}),(0,x.jsx)(p.T,{className:"ml-2 text-green-700",children:"Files uploaded successfully!"})]}),m&&(0,x.jsxs)(p.F,{className:"mt-6 bg-red-50 border-red-500",children:[(0,x.jsx)(d.A,{className:"h-5 w-5 text-red-500"}),(0,x.jsx)(p.T,{className:"ml-2 text-red-700",children:m})]}),e.length>0&&(0,x.jsxs)("div",{className:"mt-8 space-y-6",children:[(0,x.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:[(0,x.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,x.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,x.jsx)(c,{className:"h-5 w-5 text-blue-500"}),"Selected Files (",e.length,")"]})}),(0,x.jsx)("div",{className:"divide-y divide-gray-200",children:e.map(((e,a)=>{var s;return(0,x.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-150",children:(0,x.jsxs)("div",{className:"flex items-start justify-between",children:[(0,x.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,x.jsx)("div",{className:"flex-shrink-0",children:(0,x.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,x.jsx)(c,{className:"h-6 w-6 text-blue-600"})})}),(0,x.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,x.jsx)("p",{className:"text-sm font-semibold text-gray-900 truncate",children:e.name}),(0,x.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,x.jsxs)("p",{children:["Size: ",e.size," MB"]}),(0,x.jsxs)("p",{children:["Duration: ",e.duration?`${e.duration}s`:"Unknown"]}),(0,x.jsxs)("p",{children:["Type: ",(null===(s=e.type.split("/")[1])||void 0===s?void 0:s.toUpperCase())||"Unknown"]}),(0,x.jsxs)("p",{className:"truncate",children:["Path: ",e.path]})]})]})]}),(0,x.jsx)("button",{onClick:()=>C(a),className:"p-1 hover:bg-gray-100 rounded-full",children:(0,x.jsx)(o,{className:"h-5 w-5 text-gray-400"})})]})},a)}))})]}),(0,x.jsxs)("div",{className:"flex gap-4",children:[(0,x.jsxs)("button",{onClick:U,className:"flex-1 flex items-center justify-center gap-3 px-8 py-4 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-all duration-200 disabled:opacity-50",disabled:s,children:[s?(0,x.jsx)(l.A,{className:"animate-spin",size:24}):(0,x.jsx)(n,{size:24}),(0,x.jsx)("span",{className:"font-semibold",children:s?"Uploading...":"Upload Files"})]}),s&&(0,x.jsx)("button",{onClick:A,className:"px-8 py-4 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-all duration-200",children:"Cancel"})]})]})]})})}},987:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(797).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}}]);
//# sourceMappingURL=650.5beddfb3.chunk.js.map